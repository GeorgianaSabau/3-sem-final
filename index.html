<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="Wiktor, Georgiana and David">
    <title>Golf app</title>
    <link rel="stylesheet" href="css/main.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.min.css" />
    <link rel="shortcut icon" type="image/svg" href="/img/Logo.png" />
    <link href="">
</head>

<body>
    <header>
        <img class="logo" src="./media/logo.png">

    </header>
    <menu>
        <input class="menu-btn" type="checkbox" id="menu-btn">
        <label class="menu-icon" for="menu-btn"><span class="navicon"></span></label>
        <ul class="dropdown_menu">
            <li class="menu_item"><a href="" class="nav_link">
                    <h2>Home</h2>
                </a></li>

            <li class="menu_item"><a href="" class="nav_link">
                    <h2>Add buckets</h2>
                </a>
            </li>

            <li class="menu_item">
                <a href="" class="nav_link">
                    <h2>Upcoming events</h2>
                </a>
            </li>

            <li class="menu_item"><a href="" class="nav_link">
                    <h2>My buckets history</h2>
                </a>
            </li>

            <li class="menu_item"><a href="" class="nav_link">
                    <h2>Map</h2>
                </a>
            </li>
            <li class="menu_item"><a href="" class="nav_link">
                    <h2>Contact</h2>
                </a>
            </li>
            <li class="menu_item"><a href="" class="nav_link">
                    <h2>Log out</h2>
                </a>
            </li>
        </ul>
    </menu>
    <section class="function_buttons">
        <button class="function_button">
            <h1 class="function_name">Add buckets</h1>
            <img class="icon" src="./media/bucket.png">
        </button>
        <button class="function_button">
            <h1 class="function_name">Upcoming events</h1>
            <img class="icon_small" src="./media/callendar.png">
        </button>
        <button class="function_button">
            <h1 class="function_name">My buckets history</h1>
            <img class="icon" src="./media/chart.png">
            <script>
            class daysBucketsService {
                constructor() {
                  this.dataRef = _db.collection("daysBuckets");
                }
             
                // data from firebase
                // There are two ways to retrieve data stored in Cloud Firestore. Either of these methods can be used with documents, collections of documents, or the results of queries:
                // - Call a method to get the data.
                // - Set a listener to receive data-change events.
                // In this case we're using get() to get data once without listning for changes.
                async getDataByUid(uid) {
                  let snapshotData = await this.dataRef.where("uid", "==", uid).orderBy("day").get();
                  let daysBuckets = [];
                  snapshotData.forEach(doc => {
                    let data = doc.data(); // save the data in a variable
                    data.id = doc.id; // add the id to the data variable
                    daysBuckets.push(data); // push the data to the array
                  });
                  // do what ever you want with the data array üéâ
                  return daysBuckets;
                }
              
                // prepares all the data for the charts
                prepareData(daysBuckets) {
                  let day = [];
                  let buckets = [];
                  for (const dataObject of daysBuckets) { // looping through all data and pushing to arrays
                    days.push(dataObject.day);
                    buckets.push(dataObject.buckets);
                  }
                  return {
                    day,
                    buckets
                  };
                }
              
                async getPreparedDataByUid(uid) {
                  let firebaseData = await this.getDataByUid(uid); // get the data from Firebase
                  let preparedData = this.prepareData(firebaseData); // Prepare all the data. Returning an object with arrays: years, numberOfCows, milkProduction & carbonFootprint
                  console.log(preparedData);
                  return preparedData; // returning the data back to the "caller", in this case the chart pages 
                }
              
              
               async init() {
                 // let = authService.authUser.uid;
                 let uid = "daysBuckets"; // using a fixed uid - want to make sure there's data matching an uid in the database
                 let data = await daysBucketsService.getPreparedDataByUid(uid); // getting prepared data from the service
                 // call append functions with the dataset: data
                 this.appendDaysBucketsChart(data);
               };
             
             
               //appending the chart
               appendDaysBucketsChart(data) {
                 // generate chart
                 let chartContainer = document.getElementById("days");
                 this.numberOfBucketsChart = new Chart(chartContainer, {
                   type: 'line',
                   data: {
                     datasets: [{
                       data: data.buckets,
                       label: 'Number of Cows',
                       fill: false,
                       borderColor: "#e755ba",
                       backgroundColor: "#e755ba",
                       pointBackgroundColor: "#55bae7",
                       pointBorderColor: "#55bae7",
                       pointHoverBackgroundColor: "#55bae7",
                       pointHoverBorderColor: "#55bae7",
                     }],
                     labels: data.day
                   },
                   options: {
                     scales: {
                       yAxes: [{
                         ticks: {
                           min: (Math.min(...data.buckets) - 5),
                           max: (Math.max(...data.buckets) + 1)
                         }
                       }]
                     }
                   }
                 });
               }
             
               updateBucketsChartAxes(min, max) {
                 this.numberOfBucketsChart.options = {
                   scales: {
                     xAxes: [{
                       ticks: {
                         min: min,
                         max: max
                       }
                     }]
                   }
                 }
                 this.numberOfBucketsChart.update();
               };
             }
</script>
        </button>
        <section id="content">
    

            <h3>Provaaa</h3>
        </section>
        <button class="function_button">
            <h1 class="function_name">Map</h1>
            <img class="icon_small" src="./media/map.png">
        </button>
    </section>
    <main>
        <section id="signUpContainer">
       <img src="/img/Logo.png" class="auth-logo">
       
      <form> 
        <input autocomplete="email" id="signUpEmail" type="email" placeholder="Email">
       <input autocomplete="current-password" id="signUpPassw" type="password" placeholder="Password">
       <!-- <input id="signUpPassword2" type="password" placeholder="Password"> -->
       <button onclick="signUp()">sign up</button>
    </form>
            </section>

            <section id="signUpContainer">
                <img src="/img/Logo.png" class="auth-logo">
                
               <form> 
                 <input autocomplete="email" id="signUpEmail" type="email" placeholder="Email">
                <input autocomplete="current-password" id="signUpPassw" type="password" placeholder="Password">
                <!-- <input id="signUpPassword2" type="password" placeholder="Password"> -->
                <button onclick="signIn()">sign in</button>
                <p>not registered? sign up <u>here</u></p>
             </form>
                     </section>

            <section id="calendarContainer">
                <iframe src="https://calendar.google.com/calendar/embed?height=600&amp;wkst=2&amp;bgcolor=%236cc073&amp;ctz=Europe%2FBudapest&amp;src=d3JpdGVhbmVtYWlsdG9kYXZpZEBnbWFpbC5jb20&amp;src=NWhwbnF2bjNoMnZiY3JobGxyN29jdGRvMnVkcWZrbW5AaW1wb3J0LmNhbGVuZGFyLmdvb2dsZS5jb20&amp;color=%23039BE5&amp;color=%237CB342&amp;showTitle=0&amp;title=Events&amp;showPrint=0&amp;showTabs=1&amp;showCalendars=0&amp;showTz=0&amp;hl=en_GB&amp;showNav=0&amp;showDate=1" class="calendar-e"   style="border-width:0" frameborder="0" scrolling="no"></iframe>    

            </section>

            
    </main>

    <contact>
        <h1>Get in touch!</h1>
        <li class="contact_item"><a href="https://goo.gl/maps/mhuqvzkgrjT1NQidA" target="_blank" class="nav_link">
                <img class="icon" src="./media/location.png">
                <h2>≈Åagiewnicka 233, ≈Å√≥d≈∫</h2>
            </a></li>

        <li class="contact_item"><a href="tel:+48660749471" target="_blank" class="nav_link">
                <img class="icon" src="./media/smartphone.png">
                <h2>+48 660 749 471</h2>
            </a>
        </li>

        <li class="contact_item">
            <a href="mailto:golfowy@golfowy.pl" class="nav_link" target="_blank">
                <img class="icon" src="./media/email.png">
                <h2>golfowy@golfowy.pl</h2>
            </a>
        </li>

        <li class="contact_item"><a href="http://www.golfowy.pl/" target="_blank" class="nav_link">
                <img class="icon" src="./media/internet.png">
                <h2>golfowy.pl</h2>
            </a>
        </li>

        <li class="contact_item"><a href="https://www.facebook.com/golfowy" target="_blank" class="nav_link">
                <img class="icon" src="./media/facebook.png">
                <h2>facebook.com/golfowy</h2>
            </a>
        </li>
    </contact>

    <!-- Loding firebase libraries: firebase, auth, firestore & firebase ui -->
    <!-- The core Firebase JS SDK is always required and must be listed first -->
<script src="https://www.gstatic.com/firebasejs/8.1.2/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.23.0/firebase-firestore.js"></script>

<!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries -->
<script src="https://www.gstatic.com/firebasejs/8.1.2/firebase-analytics.js"></script>
    <!-- Chart.js library -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
    <script src="/script/main.js"></script>
</body>

</html>